//Centrino for Matrex
FUNCTION CENTRINO_MANDREL_MATREX(STRING $COMPANY , REAL $DIAMETER) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpath Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Entrata\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	EDIT TOOLPATH SAFEAREA SIZE "2"
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
    THICKNESS ACCEPT
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	EDIT FOLDER "Toolpath\ENTRATE" ORDER "Toolpath\ENTRATE\CENTERING HOLES" FIRST
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
}

FUNCTION CENTRINO_ALLARGATORE_MATREX(STRING $COMPANY , REAL $DIAMETER , REAL $HEIGHT , INT $PIECECODE , STRING $WP_POZZETO) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	REAL $GAP = 0
	IF $PIECECODE == 7 {
		$GAP = -6
	} ELSEIF $PIECECODE == 6 {
		$GAP = 10
	} ELSE {
		$GAP = 7
	}
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Workplane
	ACTIVATE WORKPLANE $WP_POZZETO
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $HEIGHT + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
    THICKNESS ACCEPT
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	EDIT FOLDER "Toolpath\NOCCIOLO" ORDER "Toolpath\NOCCIOLO\CENTERING HOLES" FIRST
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
}

FUNCTION CENTRINO_MATRICE_MATREX(STRING $COMPANY , BOOL $TWOPARTS , BOOL $THREEPARTS , REAL $DIAMETER , REAL $HEIGHT , INT $PIECECODE , STRING $WP_SCARICO) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\SCARICO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_SCARICO
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	REAL $GAP = 0
	IF $TWOPARTS {
		$GAP = 20
	} ELSEIF $PIECECODE == 24 OR $PIECECODE == 26 OR $PIECECODE == 28 {
		$GAP = -6
	} ELSEIF $PIECECODE == 22 OR $PIECECODE == 23 OR $PIECECODE == 27 {
		$GAP = 10
	} ELSE {
		$GAP = 10
	}
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Workplane
	ACTIVATE WORKPLANE $WP_SCARICO
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $HEIGHT + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
    THICKNESS ACCEPT
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset	
}

FUNCTION CENTRINO_PIANA_MATREX(STRING $COMPANY , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST , REAL $DIAMETER , REAL $HEIGHT , INT $PIECECODE , STRING $WP_SCARICO) {
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\SCARICO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Matrex\Powermill\Imports\CENTERING HOLES\CENTERING_HOLES.xml"
	RENAME Featureset ; "CENTERING_HOLES"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_SCARICO
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	REAL $GAP = 0
	IF $TWOPARTS AND $ALLARGATORE_FIRST {
		$GAP = 20
	} ELSEIF $PIECECODE == 7 OR $PIECECODE == 24 OR $PIECECODE == 26 OR $PIECECODE == 28 {
		$GAP = -6
	} ELSEIF $PIECECODE == 6 OR $PIECECODE == 22 OR $PIECECODE == 23 OR $PIECECODE == 27 {
		$GAP = 10
	} ELSE {
		$GAP = 10
	}
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - $GAP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES" DESELECT "CENTERING_RIGHT"

	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES               1         T203      8"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Workplane
	ACTIVATE WORKPLANE $WP_SCARICO
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $HEIGHT + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
    THICKNESS ACCEPT
	//Select Featureset Components
	ACTIVATE Featureset "CENTERING_HOLES"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_TOP"
	//EDIT FEATURESET "CENTERING_HOLES" SELECT "CENTERING_RIGHT"
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
}

//Centrino for Alumat (Mandrel/Allrgatore)
//Centrino Small Mandrel
//Non Entrata
FUNCTION CSMD1(STRING LIST $TORNDATA) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Non Pozzeto
FUNCTION CSMD2(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	REAL $HEIGHT = SUBSTRING($TORNDATA[13] , 5 , 5)
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 - 6"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 + 6"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 + 6"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
	
	
}

//Battuta Entrata
FUNCTION CSMD3(STRING LIST $TORNDATA) {
	
	//Diameter with battuta
	REAL $DIAMETER = SUBSTRING($TORNDATA[23] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Female Pozzeto
FUNCTION CSMD4(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	REAL $HEIGHT = SUBSTRING($TORNDATA[13] , 5 , 5)
	//Import Centrino Feature Set
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 - 6"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 + 6"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 + 6"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}

//Inclination Entrata
FUNCTION CSMD5(STRING LIST $TORNDATA) {
	
	//Diameter with inclination
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
	IF $DIAMETER == 0 {
		$DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	}
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Male Pozzeto
FUNCTION CSMD6(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	
	
}

//Centrino Medium Mandrel
//Non Entrata
FUNCTION CMMD1(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//(400 - (400-MAXFEED)/2)/2
	REAL $MAXFEEDING = "0"
	$MAXFEEDING = SUBSTRING($DESIGNDATA[25] , 0 , 3)
	IF $MAXFEED == 0 {
	$MAXFEEDING = INPUT "MAX FEEDING?: "
	}
	REAL $INTERNALMOVE = (400 - (400-MAXFEEDING)/2)/2
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Non Pozzeto
FUNCTION CMMD2(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 20"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 20"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 20"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
		
}
FUNCTION CMMD3(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	
	
}

//Battuta Entrata
FUNCTION CMMD4(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[23] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//(400 - (400-MAXFEED)/2)/2
	REAL $MAXFEEDING = SUBSTRING($DESIGNDATA[25] , 0 , 3)
	REAL $INTERNALMOVE = (400 - (400-MAXFEEDING)/2)/2
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Female Pozzeto
FUNCTION CMMD5(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	REAL $HEIGHT = SUBSTRING($TORNDATA[13] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}
FUNCTION CMMD6(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	REAL $HEIGHT = SUBSTRING($TORNDATA[13] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}

//Inclination Entrata
FUNCTION CMMD7(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//(400 - (400-MAXFEED)/2)/2
	REAL $MAXFEEDING = SUBSTRING($DESIGNDATA[25] , 0 , 3)
	REAL $INTERNALMOVE = (400 - (400-MAXFEEDING)/2)/2
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Male Pozzeto
FUNCTION CMMD8(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}
FUNCTION CMMD9(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	
	
}

//Centrino Large Mandrel
//Non Entrata
FUNCTION CLMD1(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
	IF $DIAMETER == 0 {
		$DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	}
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//(400 - (400-MAXFEED)/2)/2
	REAL $MAXFEEDING = SUBSTRING($DESIGNDATA[25] , 0 , 3)
	REAL $INTERNALMOVE = (400 - (400-MAXFEEDING)/2)/2
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Non Pozzeto
FUNCTION CLMD2(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}
FUNCTION CLMD3(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 20"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 20"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 20"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}

//Battuta Entrata
FUNCTION CLMD4(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[23] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//(400 - (400-MAXFEED)/2)/2
	REAL $MAXFEEDING = SUBSTRING($DESIGNDATA[25] , 0 , 3)
	REAL $INTERNALMOVE = (400 - (400-MAXFEEDING)/2)/2
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Female Pozzeto
FUNCTION CLMD5(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	REAL $HEIGHT = SUBSTRING($TORNDATA[13] , 5 , 5)
	IF $DIAMETER == 0 {
		$DIAMETER = INPUT "COLLARINO D?: "
	}
	IF $HEIGHT == 0 {
		$HEIGHT = INPUT "COLLARINO HEIGHT?: "
	}
	
	
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	ACTIVATE Featureset "CENTERING_HOLES_POZZETO"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	DEACTIVATE Featureset
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}
FUNCTION CLMD6(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	REAL $HEIGHT = SUBSTRING($TORNDATA[13] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT"
	
	ACTIVATE Featureset "CENTERING_HOLES_POZZETO"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	DEACTIVATE Featureset
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}

//Inclination Entrata
FUNCTION CLMD7(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\ENTRATA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_ENTRATA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//(400 - (400-MAXFEED)/2)/2
	REAL $MAXFEEDING = SUBSTRING($DESIGNDATA[25] , 0 , 3)
	REAL $INTERNALMOVE = (400 - (400-MAXFEEDING)/2)/2
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathEntrata()
	
}
//Male Pozzeto
FUNCTION CLMD8(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[12] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\POZZETO"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_POZZETO"
	DEACTIVATE FOLDER
	
	//Rotate Centrino to Workplane
	ACTIVATE Workplane $WP_POZZETO
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED AXIS K "1"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"	
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "-$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Y "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 20"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION X "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "0"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" DESELECT "CENTERING_RIGHT_OUT"
	
	
	
	CALL CentrinoToolpathPozzeto($WP_POZZETO)
	
}
FUNCTION CLMD9(STRING LIST $TORNDATA , STRING $WP_POZZETO) {
	
	
	
}

//Centrino for Alumat (Matrice/Piana)
//Centrino Small Matrice
//Non Collarino
FUNCTION CSMT1(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {

	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathCamera()

}
//Female Collarino
FUNCTION CSMT2(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {

	//Diameter from the 
	
	//Diameter from the die
	REAL $DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
	REAL $HEIGHT = SUBSTRING($TORNDATA[36] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
		
	//Define Movements on XYZ
	//Centering hole left
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT"
	//Centering hole top
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP"
	//Centering hole right
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT"
	
	CALL CentrinoToolpathCamera()
	
}
//Male Collarino
FUNCTION CSMT3(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
		//Diameter from the die
		REAL $DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
		DEACTIVATE Workplane
		ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
		EDIT FEATURECREATE NAME   
		EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Three Holes\CENTERING_HOLES_3H.xml"
		DELETE Workplane "1"
		RENAME Featureset ; "CENTERING_HOLES_CAMERA"
		DEACTIVATE FOLDER
		
		//Define Movements on XYZ
		//Centering hole left
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT"
		//Centering hole top
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP"
		//Centering hole right
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT"
		
		CALL CentrinoToolpathCamera()
	
	
}
//Centrino Medium Matrice
//Non Collarino
FUNCTION CMMT1(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
		//Diameter from the die
		//This tornitura code may have inclination from entrata
		REAL $DIAMETER = 0
		$DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
		IF $DIAMETER == 0 {
			$DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
		}
		
		DEACTIVATE Workplane
		ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
		EDIT FEATURECREATE NAME   
		EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
		DELETE Workplane "1"
		RENAME Featureset ; "CENTERING_HOLES_CAMERA"
		DEACTIVATE FOLDER
		
		//Centrino internal position
		//DIAMETRO PEZZO -35
		REAL $INTERNALMOVE = (($DIAMETER / 2) - 35)
		
		//Define Movements on XYZ
		//Centering hole left in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
		//Centering hole left out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
		//Centering hole top in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
		//Centering hole top out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
		//Centering hole right in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
		//Centering hole right out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
		
		CALL CentrinoToolpathCamera()
	
	
}
FUNCTION CMMT2(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
		//Diameter from the die
		//This tornitura code may have inclination from entrata
		REAL $DIAMETER = 0
		$DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
		IF $DIAMETER == 0 {
			$DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
		}
		
		DEACTIVATE Workplane
		ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
		EDIT FEATURECREATE NAME   
		EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
		DELETE Workplane "1"
		RENAME Featureset ; "CENTERING_HOLES_CAMERA"
		DEACTIVATE FOLDER
		
		//Centrino internal position
		//DIAMETRO PEZZO -35
		REAL $INTERNALMOVE = (($DIAMETER / 2) - 35)
		
		//Define Movements on XYZ
		//Centering hole left in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
		//Centering hole left out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
		//Centering hole top in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
		//Centering hole top out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
		//Centering hole right in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
		//Centering hole right out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
		
		CALL CentrinoToolpathCamera()
	
	
}
//Female Collarino
FUNCTION CMMT3(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}
	REAL $HEIGHT = SUBSTRING($TORNDATA[36] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = $DIAMETER - 10
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
		
	ACTIVATE Featureset "CENTERING_HOLES_CAMERA"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	DEACTIVATE Featureset
	
	
	CALL CentrinoToolpathCamera()
	
	
}
FUNCTION CMMT4(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}
	REAL $HEIGHT = SUBSTRING($TORNDATA[36] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = $DIAMETER - 10
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
		
	ACTIVATE Featureset "CENTERING_HOLES_CAMERA"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	DEACTIVATE Featureset
	
	
	CALL CentrinoToolpathCamera()
	
	
}
//Male Collarino
FUNCTION CMMT5(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {

	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}

	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = $DIAMETER - 35
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathCamera()
	
	
}
FUNCTION CMMT6(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {

	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}

	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = $DIAMETER - 35
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathCamera()
	
}
//Centrino Large Matrice
//Non Collarino
FUNCTION CLMT1(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
		//Diameter from the die
		//This tornitura code may have inclination from entrata
		REAL $DIAMETER = 0
		$DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
		IF $DIAMETER == 0 {
			$DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
		}
		
		DEACTIVATE Workplane
		ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
		EDIT FEATURECREATE NAME   
		EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
		DELETE Workplane "1"
		RENAME Featureset ; "CENTERING_HOLES_CAMERA"
		DEACTIVATE FOLDER
		
		//Centrino internal position
		//DIAMETRO PEZZO -35
		REAL $INTERNALMOVE = (($DIAMETER / 2) - 35)
		
		//Define Movements on XYZ
		//Centering hole left in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
		//Centering hole left out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
		//Centering hole top in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
		//Centering hole top out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
		//Centering hole right in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
		//Centering hole right out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
		
		CALL CentrinoToolpathCamera()
	
	
}
FUNCTION CLMT2(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
		//Diameter from the die
		//This tornitura code may have inclination from entrata
		REAL $DIAMETER = 0
		$DIAMETER = SUBSTRING($TORNDATA[25] , 5 , 5)
		IF $DIAMETER == 0 {
			$DIAMETER = SUBSTRING($TORNDATA[7] , 5 , 5)
		}
		
		DEACTIVATE Workplane
		ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
		EDIT FEATURECREATE NAME   
		EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
		DELETE Workplane "1"
		RENAME Featureset ; "CENTERING_HOLES_CAMERA"
		DEACTIVATE FOLDER
		
		//Centrino internal position
		//DIAMETRO PEZZO -35
		REAL $INTERNALMOVE = (($DIAMETER / 2) - 35)
		
		//Define Movements on XYZ
		//Centering hole left in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
		//Centering hole left out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
		//Centering hole top in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
		//Centering hole top out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
		//Centering hole right in
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
		//Centering hole right out
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
		EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 10"
		EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
		
		CALL CentrinoToolpathCamera()
	
	
}
//Female Collarino
FUNCTION CLMT3(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}
	REAL $HEIGHT = SUBSTRING($TORNDATA[36] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = ($DIAMETER / 2) - 10
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 - 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 + 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 + 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
		
	ACTIVATE Featureset "CENTERING_HOLES_CAMERA"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	DEACTIVATE Featureset
	
	
	CALL CentrinoToolpathCamera()
	
	
}
FUNCTION CLMT4(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {
	
	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}
	REAL $HEIGHT = SUBSTRING($TORNDATA[36] , 5 , 5)
	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = $DIAMETER - 10
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 5"
	EDIT FEATURESET ; FEATURE SELECTED POSITION Z "$HEIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
		
	ACTIVATE Featureset "CENTERING_HOLES_CAMERA"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EXPLORER EDIT SELECTED FEATURES
	EDIT FEATURESET ; FEATURE SELECTED COMPONENT SELECTED DEPTH "5"
	EDIT FEATURESET ; FEATURE SELECTED APPLYAXIS
	FORM CANCEL EDITHOLE
	DEACTIVATE Featureset
	
	
	CALL CentrinoToolpathCamera()
	
	
}
//Male Collarino
FUNCTION CLMT5(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {

	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}

	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = $DIAMETER - 35
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathCamera()
	
	
}
FUNCTION CLMT6(STRING LIST $TORNDATA , STRING LIST $DESIGNDATA) {

	//Diameter from the die
	//This tornitura code may have inclination from entrata
	REAL $DIAMETER = 0
	$DIAMETER = SUBSTRING($TORNDATA[37] , 5 , 5)
	IF $DIAMETER == 0 {
		MESSAGE ERROR "DIAMETRO COLLARINO MATRICE not found"
		MESSAGE INFO "Macro Aborted"
		MACRO ABORT
	}

	DEACTIVATE Workplane
	ACTIVATE FOLDER "Featureset\STANDARD_HOLES\CAMERA"
	EDIT FEATURECREATE NAME   
	EDIT FEATURESET ; INSERT FILE FILEOPEN "V:\Master Files\Alumat\Powermill\Imports\Centering Holes\Six Holes\CENTERING_HOLES_6H.xml"
	DELETE Workplane "1"
	RENAME Featureset ; "CENTERING_HOLES_CAMERA"
	DEACTIVATE FOLDER
	
	//Centrino internal position
	//COLLARINO - 10
	
	REAL $INTERNALMOVE = $DIAMETER - 35
	
	//Define Movements on XYZ
	//Centering hole left in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_IN"
	//Centering hole left out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "-$DIAMETER/2 + 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_LEFT_OUT"
	//Centering hole top in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_IN"
	//Centering hole top out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  Y "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_TOP_OUT"
	//Centering hole right in
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$INTERNALMOVE"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_IN"
	//Centering hole right out
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	EDIT FEATURESET ; FEATURE SELECTED POSITION  X "$DIAMETER/2 - 5"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" DESELECT "CENTERING_RIGHT_OUT"
	
	CALL CentrinoToolpathCamera()
	
}


//Drilling Toolpath Alumat
FUNCTION CentrinoToolpathEntrata() {
	
	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES ENTRATA       1         T203      10"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Alumat\Powermill\Tamplates\Entrata\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	DIALOGS MESSAGE OFF
	DIALOGS ERROR OFF
	EDIT LEVEL "264" SELECT ALL
	EDIT LEVEL "20" SELECT ALL
	EDIT LEVEL "30" SELECT ALL
	
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
    THICKNESS ACCEPT
	//Select Featureset Components
	DIALOGS MESSAGE OFF
	DIALOGS ERROR OFF
	ACTIVATE Featureset "CENTERING_HOLES_ENTRATA"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_ENTRATA" SELECT "CENTERING_RIGHT_OUT"
	DIALOGS MESSAGE ON
	DIALOGS ERROR ON
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	EDIT FOLDER "Toolpath\ENTRATE" ORDER "Toolpath\ENTRATE\CENTERING HOLES ENTRATA" FIRST
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
	
}

FUNCTION CentrinoToolpathCamera() {
	
	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES CAMERA        1         T203      10"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Alumat\Powermill\Tamplates\Camera\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	DIALOGS MESSAGE OFF
	DIALOGS ERROR OFF
	EDIT LEVEL "264" SELECT ALL
	EDIT LEVEL "20" SELECT ALL
	EDIT LEVEL "30" SELECT ALL
	
	
	EDIT BLOCK RESET
	BLOCK ACCEPT
	REAL ARRAY Lims[] = limits(block)
	REAL $MAXZ = Lims[5]
	
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $MAXZ + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
    THICKNESS ACCEPT
	//Select Featureset Components
	DIALOGS MESSAGE OFF
	DIALOGS ERROR OFF
	ACTIVATE Featureset "CENTERING_HOLES_CAMERA"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_CAMERA" SELECT "CENTERING_RIGHT_OUT"
	DIALOGS MESSAGE ON
	DIALOGS ERROR ON
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	EDIT FOLDER "Toolpath\CAMERA SGR" ORDER "Toolpath\CAMERA SGR\CENTERING HOLES CAMERA" FIRST
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
	
}




FUNCTION CentrinoToolpathPozzeto(STRING $WP_POZZETO) {
	
	//Toolpaths Variables
	//CENTERING_HOLES           Toolpath                Index       Tool    Depth
	//                              10        20        30        40        50
	//                      012345678901234567890123456789012345678901234567890
	STRING $PACKET       = "CENTERING HOLES POZZETO       1         T203      10"
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
	INT $INDEX = SUBSTRING($PACKET , 30 , 1)
	STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
	REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 3)
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW	
	
	//Import Toolpath
	IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
		DELETE Toolpath $PATHNAME NOQUIBBLE
	}
	
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Alumat\Powermill\Tamplates\Pozzeto\Centrino\Centrino.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Drill Toolpath
	ACTIVATE Toolpath $PATHNAME
	//Workplane
	ACTIVATE WORKPLANE $WP_POZZETO
	
	EDIT BLOCK RESET
	BLOCK ACCEPT
	REAL ARRAY Lims[] = limits(block)
	REAL $MAXZ = Lims[5]
	//Depth
	EDIT DRILL DEPTH $DRILLDEPTH
	//Tool
	CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
	ACTIVATE TOOL $NAME
	EDIT RPM $SPEED
	EDIT FRATE $FEED
	EDIT PRATE $PLUNGE
	//Rapids
	REAL $RAPIDHEIGHT = $MAXZ + 2
	EDIT TOOLPATH SAFEAREA SIZE $RAPIDHEIGHT
	EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  $RAPIDHEIGHT
	//Component Thickness
	EDIT TOOLPATH THICKNESS LIST UPDATE 4 NEW
	EDIT TOOLPATH ; THICKNESS ACQUIRE
	EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
    THICKNESS ACCEPT
	//Select Featureset Components
	DIALOGS MESSAGE OFF
	DIALOGS ERROR OFF
	ACTIVATE Featureset "CENTERING_HOLES_POZZETO"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_LEFT_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_TOP_OUT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_IN"
	EDIT FEATURESET "CENTERING_HOLES_POZZETO" SELECT "CENTERING_RIGHT_OUT"
	DIALOGS MESSAGE ON
	DIALOGS ERROR ON
	//Calculate
	EDIT TOOLPATH $PATHNAME CALCULATE
	EDIT FOLDER "Toolpath\NOCCIOLO" ORDER "Toolpath\NOCCIOLO\CENTERING HOLES POZZETO" FIRST
	BLANK UNDO
	DEACTIVATE Toolpath
	DEACTIVATE Tool
	DEACTIVATE Featureset
	
}




